<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>스트레스 취약성 검사</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #2d3748;
            line-height: 1.6;
        }

        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* 헤더 스타일 - 얇고 긴 제목 박스 */
        .header {
            text-align: center;
            margin-bottom: 1rem;
        }

        .title-box {
            background: rgba(255,255,255,0.15); /* 배경보다 약간 밝은 색 */
            border-radius: 0.5rem;
            padding: 0.75rem 2rem; /* 얇게 조정 */
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 0;
            display: inline-block;
            min-width: 400px; /* 길게 조정 */
            max-width: 90%;
        }

        .title {
            font-size: 28px; /* 고정 크기 */
            font-weight: 800;
            color: #ffffff; /* 흰색으로 변경 */
            margin-bottom: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .subtitle {
            font-size: 16px; /* 고정 크기 */
            color: rgba(255,255,255,0.9); /* 흰색 반투명 */
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-top: 0.25rem;
        }

        .progress-container {
            text-align: center;
            margin-bottom: 2rem;
        }

        .progress {
            font-size: 14px; /* 고정 크기 */
            color: #718096;
            font-weight: 600;
            background: rgba(255,255,255,0.9);
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            display: inline-block;
            backdrop-filter: blur(10px);
            white-space: nowrap;
        }

        .filter-text {
            font-size: 12px;
            color: #a0aec0;
            font-style: italic;
            margin-left: 0.5rem;
        }

        /* 카드 스타일 */
        .card {
            background: rgba(255,255,255,0.95);
            border-radius: 1.5rem;
            padding: 2.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }

        .intro-card {
            text-align: center;
            margin-top: 4rem;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .intro-title {
            font-size: 32px; /* 고정 크기 */
            font-weight: 900;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .intro-subtitle {
            font-size: 18px; /* 고정 크기 */
            color: #718096;
            margin-bottom: 2rem;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* QR코드 스타일 */
        .qr-section {
            margin-top: 2rem;
            padding: 2rem;
            background: rgba(255,255,255,0.95);
            border-radius: 1.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .qr-title {
            font-size: 20px; /* 고정 크기 */
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 1rem;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .qr-description {
            font-size: 14px; /* 고정 크기 */
            color: #718096;
            margin-bottom: 1.5rem;
            text-align: center;
            line-height: 1.6;
        }

        .qr-container {
            display: flex;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        .qr-code {
            padding: 1rem;
            background: white;
            border-radius: 1rem;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            min-width: 200px;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .qr-instructions {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            padding: 1.5rem;
            border-radius: 1rem;
            border-left: 4px solid #667eea;
        }

        .qr-instructions h4 {
            color: #2d3748;
            font-size: 16px; /* 고정 크기 */
            font-weight: 700;
            margin-bottom: 0.75rem;
        }

        .qr-instructions ol {
            color: #4a5568;
            font-size: 14px; /* 고정 크기 */
            padding-left: 1.5rem;
            line-height: 1.6;
        }

        .qr-instructions li {
            margin-bottom: 0.5rem;
        }

        /* 질문 카드 */
        .question-card {
            margin-bottom: 1.5rem;
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .question-card.no-animation {
            animation: none !important;
        }

        .q-number {
            font-size: 18px; /* 고정 크기 */
            font-weight: 700;
            color: #667eea;
            margin-bottom: 1rem;
            text-align: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .q-text {
            font-size: 20px; /* 고정 크기 */
            line-height: 1.7;
            color: #2d3748;
            text-align: center;
            font-weight: 500;
            word-break: keep-all; /* 한글 줄바꿈 방지 */
            white-space: normal; /* 질문 텍스트는 여러 줄 허용 */
        }

        /* 버튼 스타일 */
        .primary-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 1rem 2rem;
            border-radius: 1rem;
            border: none;
            font-size: 18px; /* 고정 크기 */
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
            width: 100%;
            margin-top: 1.5rem;
            white-space: nowrap;
        }

        .primary-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }

        .primary-button:active {
            transform: translateY(0);
        }

        .primary-button:disabled {
            background: linear-gradient(135deg, #cbd5e0, #a0aec0);
            color: #e2e8f0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .answer-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .answer-button {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            padding: 1.25rem 1.5rem;
            border-radius: 1rem;
            border: none;
            font-size: 16px; /* 고정 크기 */
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 16px rgba(72, 187, 120, 0.3);
            position: relative;
            overflow: hidden;
            white-space: nowrap;
        }

        .answer-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .answer-button:hover::before {
            left: 100%;
        }

        .answer-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(72, 187, 120, 0.4);
        }

        .answer-button.selected {
            background: linear-gradient(135deg, #2f855a, #276749);
            transform: scale(1.02);
            box-shadow: 0 12px 24px rgba(47, 133, 90, 0.5);
        }

        /* 네비게이션 - 질문 페이지용 (더 큰 크기) */
        .footer-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
            padding-top: 1rem;
            gap: 0.8rem; /* 간격 더 늘림 */
        }

        .nav-pill {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 1rem 1.4rem; /* 패딩 더 늘림 */
            border-radius: 2rem;
            border: none;
            font-size: 15px; /* 폰트 크기 더 늘림 */
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px; /* 최소 너비 더 늘림 */
            box-shadow: 0 6px 12px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
            white-space: nowrap;
            flex: 1; /* 동일한 크기로 분배 */
            max-width: 140px; /* 최대 너비 더 늘림 */
        }

        .nav-pill::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .nav-pill:hover::before {
            left: 100%;
        }

        .nav-pill:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.4);
        }

        .nav-pill:disabled {
            background: linear-gradient(135deg, #cbd5e0, #a0aec0);
            color: #e2e8f0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .nav-pill.secondary {
            background: linear-gradient(135deg, #e2e8f0, #cbd5e0);
            color: #4a5568;
        }

        .nav-pill.dev-button {
            background: linear-gradient(135deg, #6b7280, #9ca3af);
        }

        .center-buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.8rem; /* 간격 더 늘림 */
            flex: 1;
            max-width: 140px;
        }

        /* 답변 현황 */
        .review-container {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            margin-bottom: 6rem;
        }

        .section {
            background: rgba(255,255,255,0.95);
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .section-title {
            font-size: 18px; /* 고정 크기 */
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 1.5rem;
            white-space: nowrap;
        }

        .question-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 1rem;
        }

        .answered-badge, .unanswered-badge {
            border-radius: 1rem;
            padding: 0.75rem;
            text-align: center;
            cursor: pointer;
            border: 2px solid;
            transition: all 0.3s ease;
            font-weight: 600;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .answered-badge:hover, .unanswered-badge:hover {
            transform: scale(1.1);
        }

        .answered-badge {
            background: linear-gradient(135deg, #c6f6d5, #9ae6b4);
            border-color: #48bb78;
            color: #22543d;
        }

        .unanswered-badge {
            background: linear-gradient(135deg, #fed7d7, #feb2b2);
            border-color: #f56565;
            color: #742a2a;
        }

        .q-badge-num {
            font-size: 14px; /* 고정 크기 */
            font-weight: 700;
        }

        /* 🆕 새로운 결과 페이지 스타일 - 영역별 분리 */
        .area-section {
            margin-bottom: 3rem;
        }

        .area-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .area-title-box {
            background: rgba(255,255,255,0.15);
            border-radius: 0.5rem;
            padding: 0.75rem 2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 0.5rem;
            display: inline-block;
            min-width: 300px;
            max-width: 90%;
        }

        .area-title {
            font-size: 24px; /* 고정 크기 */
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            white-space: nowrap;
        }

        .area-subtitle {
            font-size: 16px; /* 고정 크기 */
            color: rgba(255,255,255,0.9);
            font-weight: 500;
            white-space: nowrap;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .type-card {
            background: rgba(255,255,255,0.95);
            border-radius: 1.5rem;
            padding: 1.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }

        .type-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }

        .type-header {
            text-align: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .type-label {
            font-size: 18px; /* 고정 크기 */
            font-weight: 800;
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .type-name {
            font-size: 16px; /* 고정 크기 */
            font-weight: 600;
            color: #4a5568;
        }

        .questions-section {
            margin-bottom: 1.5rem;
        }

        .question-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .question-item:last-child {
            border-bottom: none;
        }

        .question-num {
            font-size: 14px; /* 고정 크기 */
            font-weight: 600;
            color: #64748b;
        }

        .question-score {
            font-size: 14px; /* 고정 크기 */
            font-weight: 700;
            color: #2d3748;
            background: #f8fafc;
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            min-width: 30px;
            text-align: center;
        }

        .score-section {
            text-align: center;
            padding-top: 1rem;
            border-top: 2px solid #e2e8f0;
        }

        .traffic-light {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .traffic-icon {
            font-size: 20px; /* 고정 크기 */
        }

        .traffic-text {
            font-size: 14px; /* 고정 크기 */
            font-weight: 700;
        }

        .total-score {
            font-size: 24px; /* 고정 크기 */
            font-weight: 800;
        }

        /* 실천 전략 */
        .plan-card {
            background: rgba(255,255,255,0.95);
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 6rem;
        }

        .plan-input {
            width: 100%;
            min-height: 300px;
            font-size: 16px; /* 고정 크기 */
            color: #2d3748;
            border: 2px solid #e2e8f0;
            border-radius: 1rem;
            padding: 1.5rem;
            resize: vertical;
            font-family: inherit;
            line-height: 1.7;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.8);
        }

        .plan-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: white;
        }

        .plan-input::placeholder {
            color: #a0aec0;
            font-weight: 500;
        }

        /* 이메일 입력 스타일 */
        .email-card {
            background: rgba(255,255,255,0.95);
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 6rem;
        }

        .email-input {
            width: 100%;
            padding: 1rem 1.5rem;
            font-size: 16px; /* 고정 크기 */
            color: #2d3748;
            border: 2px solid #e2e8f0;
            border-radius: 1rem;
            font-family: inherit;
            line-height: 1.7;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.8);
            margin-bottom: 1.5rem;
        }

        .email-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: white;
        }

        .email-input::placeholder {
            color: #a0aec0;
            font-weight: 500;
        }

        /* 이메일 성공 화면 스타일 */
        .success-card {
            background: rgba(255,255,255,0.95);
            padding: 3rem;
            border-radius: 1.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            text-align: center;
            margin-bottom: 6rem;
        }

        .success-icon {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            display: block;
        }

        .success-title {
            font-size: 24px; /* 고정 크기 */
            font-weight: 800;
            color: #38a169;
            margin-bottom: 1rem;
        }

        .success-message {
            font-size: 16px; /* 고정 크기 */
            color: #4a5568;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        /* 하단 바 - 원래 크기로 복원 */
        .footer-bar {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            right: 2rem;
            max-width: 1160px;
            margin: 0 auto;
        }

        .footer-bar .nav-pill {
            width: 100%;
            padding: 1rem 2rem; /* 원래 크기로 복원 */
            font-size: 18px; /* 원래 크기로 복원 */
            min-width: auto; /* 원래대로 */
            max-width: none; /* 원래대로 */
            flex: none; /* 원래대로 */
        }

        /* 해석 가이드 */
        .interpretation-guide {
            margin-top: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            background: rgba(255,255,255,0.9);
            padding: 2rem;
            border-radius: 1rem;
            backdrop-filter: blur(10px);
        }

        .interpretation-title {
            color: #2d3748;
            font-weight: 700;
            font-size: 18px; /* 고정 크기 */
        }

        .traffic-guide {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .traffic-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .traffic-item .traffic-icon {
            font-size: 18px; /* 고정 크기 */
        }

        .traffic-item .traffic-text {
            font-size: 16px; /* 고정 크기 */
            color: #4a5568;
            font-weight: 500;
        }

        .interpretation-text {
            color: #4a5568;
            font-size: 16px; /* 고정 크기 */
            font-weight: 500;
        }

        .score-red {
            color: #e53e3e;
            font-weight: 800;
        }

        .score-green {
            color: #38a169;
            font-weight: 800;
        }

        /* 반응형 디자인 - 질문 페이지 버튼 더 크게 */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .card {
                padding: 1.5rem;
            }
            
            .question-card {
                min-height: 150px;
            }
            
            /* 질문 페이지 네비게이션 버튼 더 크게 */
            .footer-nav .nav-pill {
                font-size: 14px !important; /* 13px → 14px */
                padding: 0.8rem 1rem !important; /* 0.7rem 0.9rem → 0.8rem 1rem */
                min-width: 80px !important; /* 75px → 80px */
                max-width: 110px !important; /* 105px → 110px */
            }
            
            .footer-nav {
                gap: 0.5rem !important; /* 0.4rem → 0.5rem */
            }
            
            .footer-nav .center-buttons {
                gap: 0.5rem !important; /* 0.4rem → 0.5rem */
                max-width: 110px !important; /* 105px → 110px */
            }
            
            .question-grid {
                grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
                gap: 0.75rem;
            }
            
            .answered-badge, .unanswered-badge {
                min-height: 45px;
                padding: 0.5rem;
            }

            .qr-section {
                padding: 1.5rem;
            }

            /* 모바일에서도 제목 크기 유지 */
            .title {
                font-size: 24px !important;
            }
            
            .intro-title {
                font-size: 28px !important;
            }

            .title-box {
                min-width: 300px;
                padding: 0.5rem 1.5rem;
            }

            /* 결과 페이지 태블릿 최적화 - 4x1 유지하되 크기 축소 */
            .results-grid {
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 0.5rem !important;
            }

            .type-card {
                padding: 0.75rem !important;
            }

            .type-label {
                font-size: 14px !important;
            }

            .type-name {
                font-size: 12px !important;
            }

            .question-item {
                padding: 0.25rem 0 !important;
            }

            .question-num {
                font-size: 12px !important;
            }

            .question-score {
                font-size: 12px !important;
                padding: 0.125rem 0.25rem !important;
                min-width: 25px !important;
            }

            .traffic-icon {
                font-size: 16px !important;
            }

            .traffic-text {
                font-size: 12px !important;
            }

            .total-score {
                font-size: 18px !important;
            }

            .area-title-box {
                min-width: 250px;
                padding: 0.5rem 1.5rem;
            }

            .area-title {
                font-size: 20px !important;
            }

            .traffic-guide {
                gap: 0.5rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0.75rem;
            }
            
            .card {
                padding: 1rem;
            }
            
            /* 더 작은 화면에서 질문 페이지 버튼 더 크게 */
            .footer-nav .nav-pill {
                font-size: 13px !important; /* 12px → 13px */
                padding: 0.7rem 0.8rem !important; /* 0.6rem 0.7rem → 0.7rem 0.8rem */
                min-width: 70px !important; /* 65px → 70px */
                max-width: 95px !important; /* 90px → 95px */
            }
            
            .footer-nav {
                gap: 0.4rem !important; /* 0.3rem → 0.4rem */
            }
            
            .footer-nav .center-buttons {
                gap: 0.4rem !important; /* 0.3rem → 0.4rem */
                max-width: 95px !important; /* 90px → 95px */
            }
            
            .question-grid {
                grid-template-columns: repeat(auto-fill, minmax(45px, 1fr));
                gap: 0.5rem;
            }
            
            .answered-badge, .unanswered-badge {
                min-height: 40px;
                padding: 0.375rem;
            }

            .qr-section {
                padding: 1rem;
            }

            /* 작은 화면에서도 제목 크기 유지 */
            .title {
                font-size: 20px !important;
            }
            
            .intro-title {
                font-size: 24px !important;
            }

            .title-box {
                min-width: 250px;
                padding: 0.5rem 1rem;
            }

            /* 결과 페이지 모바일 최적화 - 4x1 유지하되 더 작게 */
            .results-grid {
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 0.25rem !important;
            }

            .type-card {
                padding: 0.5rem !important;
            }

            .type-header {
                margin-bottom: 0.75rem !important;
                padding-bottom: 0.5rem !important;
            }

            .type-label {
                font-size: 12px !important;
            }

            .type-name {
                font-size: 10px !important;
            }

            .questions-section {
                margin-bottom: 0.75rem !important;
            }

            .question-item {
                padding: 0.125rem 0 !important;
            }

            .question-num {
                font-size: 10px !important;
            }

            .question-score {
                font-size: 10px !important;
                padding: 0.125rem 0.25rem !important;
                min-width: 20px !important;
            }

            .score-section {
                padding-top: 0.5rem !important;
            }

            .traffic-light {
                margin-bottom: 0.25rem !important;
            }

            .traffic-icon {
                font-size: 14px !important;
            }

            .traffic-text {
                font-size: 10px !important;
            }

            .total-score {
                font-size: 16px !important;
            }

            .area-title-box {
                min-width: 200px;
                padding: 0.5rem 1rem;
            }

            .area-title {
                font-size: 18px !important;
            }

            .traffic-item .traffic-text {
                font-size: 14px !important;
            }
        }

        /* 애니메이션 */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card {
            animation: fadeIn 0.6s ease-out;
        }

        /* 출처 스타일 */
        .citation {
            text-align: center;
            margin-top: 2rem;
            padding: 1rem;
            color: rgba(255,255,255,0.7);
            font-size: 12px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div id="app"></div>
    </div>

    <!-- QR코드 라이브러리 -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    
    <!-- EmailJS 라이브러리 -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <script>
        // EmailJS 초기화 - 실제 Public Key로 변경됨
        emailjs.init("gQJMP6li6AStVjesO");

        // 질문 데이터
        const questions = [
            { id: 1, text: "적절한 음식을 적당량 먹는다.", type: "A" },
            { id: 2, text: "점심식사 때 술을 마시지 않는다.", type: "B" },
            { id: 3, text: "일주일에 적어도 3번 정도는 땀이 날 정도로 운동을 한다.", type: "C" },
            { id: 4, text: "친구나 친척과 정기적 모임이나 동창 모임을 갖는다.", type: "D" },
            { id: 5, text: "나의 성생활에 만족한다.", type: "E" },
            { id: 6, text: "적어도 한 가지 이상의 여가활동이나 규칙적으로 즐기는 흥미거리가 있다.", type: "F" },
            { id: 7, text: "주말에는 일하지 않고 쉬거나 여가활동을 한다.", type: "G" },
            { id: 8, text: "규칙적으로 기도를 하거나 명상을 한다.", type: "H" },
            { id: 9, text: "하루에 커피, 또는 콜라 등을 5잔 이상 마시지 않는다.", type: "A" },
            { id: 10, text: "음료수를 술 마시기보다 더 좋아한다.", type: "B" },
            { id: 11, text: "일상생활 가운데 적당한 신체에너지를 사용하는 일을 한다.", type: "C" },
            { id: 12, text: "규칙적으로 애정을 주고받는다.", type: "D" },
            { id: 13, text: "규칙적으로 성적 만족감을 취한다.", type: "E" },
            { id: 14, text: "매일 휴식시간을 갖는다.", type: "F" },
            { id: 15, text: "할 수 있는 일(현실적인 일)만 하며 과도하게 일하지 않는다.", type: "G" },
            { id: 16, text: "나의 문제를 내 스스로 해결한다.", type: "H" },
            { id: 17, text: "나의 키에 알맞은 적절한 체중을 유지한다.", type: "A" },
            { id: 18, text: "나 혼자서는 술을 마시지 않는다.", type: "B" },
            { id: 19, text: "엘리베이터나 승강기를 이용하기보다는 계단을 걸어 올라간다.", type: "C" },
            { id: 20, text: "부정적 감정을 쌓아두기보다는 잘 표현한다.", type: "D" },
            { id: 21, text: "성적으로 무력하거나 냉담하지 않다.", type: "E" },
            { id: 22, text: "적어도 일주일에 나흘 정도는 7~8시간 잠을 잔다.", type: "F" },
            { id: 23, text: "결코 일(사업)이 나의 생활을 지배하도록 두지 않는다.", type: "G" },
            { id: 24, text: "나 자신을 믿는다.", type: "H" },
            { id: 25, text: "음식에 소금을 과하게 넣지 않는다.", type: "A" },
            { id: 26, text: "퇴근 후 집에서 술을 잘 마시지 않는다.", type: "B" },
            { id: 27, text: "규칙적인 운동 프로그램을 실천한다.", type: "C" },
            { id: 28, text: "매우 절친한 친구가 있어 그들과 은밀한 문제를 논의할 수 있다.", type: "D" },
            { id: 29, text: "사랑이 충만한 성관계를 갖는다.", type: "E" },
            { id: 30, text: "일주일에 적어도 한번은 재미있는 일을 한다.", type: "F" },
            { id: 31, text: "사회생활에서 나 자신의 사업에 대해 말하는 것을 피한다.", type: "G" },
            { id: 32, text: "내 마음이 평안하다는 느낌을 갖는다.", type: "H" },
            { id: 33, text: "매일 규칙적으로 식사를 하고 군것질은 하지 않는다.", type: "A" },
            { id: 34, text: "적당하게 술을 마시거나(하루 2잔 미만), 전혀 마시지 않는다.", type: "B" },
            { id: 35, text: "매주 한가지 이상의 운동을 한다.", type: "C" },
            { id: 36, text: "직장에서 나를 정서적으로 지지해 주는 동료가 있다.", type: "D" },
            { id: 37, text: "안정된 성관계를 유지하길 좋아한다.", type: "E" },
            { id: 38, text: "나 스스로 즐거운 일거리를 마련할 수 있다.", type: "F" },
            { id: 39, text: "야간에는 일하지 않는다.", type: "G" },
            { id: 40, text: "어떤 일이나 어떤 단체에 대해 높은 소속감을 갖는다.", type: "H" },
            { id: 41, text: "규칙적으로 물을 마신다.", type: "A" },
            { id: 42, text: "하루 3개피 이하의 담배를 피우거나 아예 피우지 않는다.", type: "B" },
            { id: 43, text: "매일 산책하거나 길을 걷는다.", type: "C" },
            { id: 44, text: "친구로부터 도움을 구하거나 필요하면 전문적 충고를 받는다.", type: "D" },
            { id: 45, text: "거의 성적 좌절감을 느끼지 않는다.", type: "E" },
            { id: 46, text: "아무것도 하지 않고도 시간을 보낼 수 있다.", type: "F" },
            { id: 47, text: "가정생활과 직장생활이 나에게는 똑같이 중요하다.", type: "G" },
            { id: 48, text: "스트레스 상황을 극복하는 것을 배운 적이 있다.", type: "H" }
        ];

        // 유형별 질문 번호
        const typeInfo = {
            A: { name: "식생활", questions: [1, 9, 17, 25, 33, 41] },
            B: { name: "금주/금연", questions: [2, 10, 18, 26, 34, 42] },
            C: { name: "운동 실천", questions: [3, 11, 19, 27, 35, 43] },
            D: { name: "정서적 안정", questions: [4, 12, 20, 28, 36, 44] },
            E: { name: "성생활", questions: [5, 13, 21, 29, 37, 45] },
            F: { name: "여가활동", questions: [6, 14, 22, 30, 38, 46] },
            G: { name: "일생활균형", questions: [7, 15, 23, 31, 39, 47] },
            H: { name: "자기이해수용", questions: [8, 16, 24, 32, 40, 48] }
        };

        // 앱 상태
        let state = {
            screen: 'intro',
            currentQuestion: 0,
            answers: {},
            pendingChoice: null,
            planText: '',
            questionFilter: 'all',
            unansweredQuestions: [],
            sessionAnsweredCount: 0,
            userEmail: '',
            senderName: '' // 보내는 사람 이름
        };

        // QR코드 생성
        function generateQRCode() {
            const currentURL = window.location.href;
            const qrContainer = document.getElementById('qr-code');
            
            if (qrContainer && typeof QRCode !== 'undefined') {
                QRCode.toCanvas(qrContainer, currentURL, {
                    width: 200,
                    height: 200,
                    colorDark: '#2d3748',
                    colorLight: '#ffffff',
                    margin: 2,
                    errorCorrectionLevel: 'M'
                }, function (error) {
                    if (error) {
                        console.error('QR코드 생성 오류:', error);
                        qrContainer.innerHTML = '<p style="color: #e53e3e; font-size: 14px;">QR코드 생성 실패</p>';
                    }
                });
            }
        }

        // 점수 계산
        function calculateScores() {
            const scores = {};
            Object.keys(typeInfo).forEach(type => {
                const qs = typeInfo[type].questions;
                scores[type] = qs.reduce((sum, qNum) => sum + (state.answers[qNum] || 0), 0);
            });
            return scores;
        }

        // 점수 색상
        function getScoreColor(score) {
            if (score <= 9) return '#e53e3e';
            if (score >= 15) return '#38a169';
            return '#2d3748';
        }

        // 🔧 완전히 수정된 이메일 전송 함수
        function sendEmail() {
            console.log('=== 이메일 전송 시작 ===');
            
            const email = document.getElementById('email-input').value.trim();
            const senderName = document.getElementById('sender-name').value.trim();
            
            console.log('입력된 이메일:', email);
            console.log('입력된 이름:', senderName);
            
            if (!email) {
                alert('이메일 주소를 입력해주세요.');
                console.log('❌ 이메일 주소 누락');
                return;
            }
            
            if (!senderName) {
                alert('이름을 입력해주세요.');
                console.log('❌ 이름 누락');
                return;
            }

            // 이메일 형식 검증
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('올바른 이메일 형식을 입력해주세요.');
                console.log('❌ 이메일 형식 오류');
                return;
            }

            console.log('✅ 입력 검증 통과');

            // 로딩 시작 - 간단하게 처리
            const button = document.getElementById('send-button');
            if (button) {
                button.disabled = true;
                button.textContent = '전송 중...';
            }

            console.log('✅ 로딩 상태 시작');

            // 검사 결과 생성
            const scores = calculateScores();
            const resultsText = generateResultsText(scores);
            
            console.log('생성된 점수:', scores);
            console.log('생성된 결과 텍스트:', resultsText);
            
            // EmailJS 템플릿 파라미터
            const templateParams = {
                to_email: email,
                sender_name: senderName, // 보내는 사람 이름
                results: resultsText,
                plan: state.planText || '작성하지 않음',
                date: new Date().toLocaleDateString('ko-KR')
            };

            console.log('템플릿 파라미터:', templateParams);
            console.log('EmailJS 설정:');
            console.log('- Public Key: gQJMP6li6AStVjesO');
            console.log('- Service ID: service_2tdscta');
            console.log('- Template ID: template_z956dv7');

            // 이메일 전송 - 실제 Service ID와 Template ID로 변경됨
            emailjs.send('service_2tdscta', 'template_z956dv7', templateParams)
                .then(function(response) {
                    console.log('✅ 이메일 전송 성공!', response.status, response.text);
                    state.screen = 'email-success';
                    render();
                }, function(error) {
                    console.error('❌ 이메일 전송 실패:', error);
                    console.error('오류 상세:', JSON.stringify(error, null, 2));
                    alert('이메일 전송에 실패했습니다. 콘솔을 확인해주세요.');
                    // 로딩 종료 - 간단하게 처리
                    if (button) {
                        button.disabled = false;
                        button.textContent = '이메일 전송하기';
                    }
                });
        }

        // 결과 텍스트 생성
        function generateResultsText(scores) {
            let text = '=== 스트레스 취약성 검사 결과 ===\n\n';
            
            Object.keys(typeInfo).forEach(type => {
                const score = scores[type];
                const typeName = typeInfo[type].name;
                let interpretation = '';
                
                if (score <= 9) {
                    interpretation = '주의 (🔴)';
                } else if (score >= 15) {
                    interpretation = '양호 (🟢)';
                } else {
                    interpretation = '보통 (🟡)';
                }
                
                text += `${type}유형 (${typeName}): ${score}점 - ${interpretation}\n`;
            });
            
            text += '\n=== 해석 가이드 ===\n';
            text += '🟢 15점 이상: 양호 - 잘 견디고 있다는 증거\n';
            text += '🟡 10-14점: 보통 - 일반적인 수준\n';
            text += '🔴 9점 이하: 주의 - 스트레스에 대한 반응이 부정적 경향\n';
            
            return text;
        }

        // 테스트 리셋
        function resetTest() {
            state = {
                screen: 'intro',
                currentQuestion: 0,
                answers: {},
                pendingChoice: null,
                planText: '',
                questionFilter: 'all',
                unansweredQuestions: [],
                sessionAnsweredCount: 0,
                userEmail: '',
                senderName: ''
            };
        }

        // 답변 선택
        function selectAnswer(score) {
            state.pendingChoice = score;
            render();
        }

        // 필터링된 질문들 반환
        function getFilteredQuestions() {
            if (state.questionFilter === 'answered') {
                return questions.filter(q => state.answers[q.id] !== undefined);
            } else if (state.questionFilter === 'unanswered') {
                return state.unansweredQuestions.map(qNum => questions.find(q => q.id === qNum)).filter(Boolean);
            }
            return questions;
        }

        // 현재 질문 정보
        function getCurrentQuestionInfo() {
            const filteredQuestions = getFilteredQuestions();
            const currentIndex = filteredQuestions.findIndex(q => q.id === questions[state.currentQuestion].id);
            
            let current = currentIndex + 1;
            let total = filteredQuestions.length;
            
            if (state.questionFilter === 'unanswered') {
                current = state.sessionAnsweredCount + 1;
                total = state.unansweredQuestions.length;
            }
            
            return {
                current: current,
                total: total,
                isFirst: currentIndex === 0,
                isLast: currentIndex === filteredQuestions.length - 1
            };
        }

        // 다음으로 진행
        function confirmAndNext() {
            const qNum = state.currentQuestion + 1;
            if (state.pendingChoice !== null) {
                state.answers[qNum] = state.pendingChoice;
                
                if (state.questionFilter === 'unanswered') {
                    state.sessionAnsweredCount++;
                }
            }
            state.pendingChoice = null;
            
            const filteredQuestions = getFilteredQuestions();
            const currentIndex = filteredQuestions.findIndex(q => q.id === questions[state.currentQuestion].id);
            
            if (currentIndex < filteredQuestions.length - 1) {
                const nextQuestion = filteredQuestions[currentIndex + 1];
                const nextIndex = questions.findIndex(q => q.id === nextQuestion.id);
                state.currentQuestion = nextIndex;
            } else {
                state.screen = 'review';
            }
            render();
        }

        // 이전 질문
        function goToPrevious() {
            const filteredQuestions = getFilteredQuestions();
            const currentIndex = filteredQuestions.findIndex(q => q.id === questions[state.currentQuestion].id);
            
            if (currentIndex > 0) {
                const prevQuestion = filteredQuestions[currentIndex - 1];
                const prevIndex = questions.findIndex(q => q.id === prevQuestion.id);
                state.currentQuestion = prevIndex;
                state.pendingChoice = state.answers[prevQuestion.id] ?? null;
            }
            render();
        }

        // 다음 질문
        function goToNext() {
            const filteredQuestions = getFilteredQuestions();
            const currentIndex = filteredQuestions.findIndex(q => q.id === questions[state.currentQuestion].id);
            
            if (currentIndex < filteredQuestions.length - 1) {
                const nextQuestion = filteredQuestions[currentIndex + 1];
                const nextIndex = questions.findIndex(q => q.id === nextQuestion.id);
                state.currentQuestion = nextIndex;
                state.pendingChoice = state.answers[nextQuestion.id] ?? null;
            }
            render();
        }

        // 특정 질문으로 이동
        function goToQuestion(index) {
            state.currentQuestion = index;
            state.pendingChoice = state.answers[index + 1] ?? null;
            state.screen = 'question';
            
            if (state.questionFilter === 'unanswered') {
                state.unansweredQuestions = getUnansweredQuestions();
                state.sessionAnsweredCount = 0;
            }
            
            render();
        }

        // 답변 완료된 질문들
        function getAnsweredQuestions() {
            return Object.keys(state.answers).map(Number).sort((a,b) => a-b);
        }

        // 미답변 질문들
        function getUnansweredQuestions() {
            const answered = new Set(getAnsweredQuestions());
            return Array.from({length:48},(_,i)=>i+1).filter(n=>!answered.has(n));
        }

        // 화면 렌더링
        function render() {
            const app = document.getElementById('app');
            
            if (state.screen === 'intro') {
                app.innerHTML = `
                    <div class="container">
                        <div class="intro-card card">
                            <h1 class="intro-title">스트레스 취약성 검사</h1>
                            <p class="intro-subtitle">총 48문항 | 가장 가까운 답을 선택하세요</p>
                            <button class="primary-button" onclick="state.screen='question'; render();">시작하기</button>
                        </div>

                        <div class="qr-section">
                            <h2 class="qr-title">📱 QR코드로 모바일에서 접속하기</h2>
                            <p class="qr-description">
                                아래 QR코드를 스캔하면 모바일 기기에서도 같은 검사를 받을 수 있습니다.
                            </p>
                            
                            <div class="qr-container">
                                <canvas id="qr-code" class="qr-code"></canvas>
                            </div>

                            <div class="qr-instructions">
                                <h4>📋 사용 방법</h4>
                                <ol>
                                    <li>스마트폰의 카메라 앱 또는 QR코드 스캔 앱을 실행하세요</li>
                                    <li>위의 QR코드를 스캔하세요</li>
                                    <li>자동으로 이 검사 페이지가 열립니다</li>
                                    <li>모바일에서도 편리하게 검사를 받을 수 있습니다</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                `;
                
                setTimeout(generateQRCode, 100);
            }
            
            else if (state.screen === 'question') {
                const qNum = state.currentQuestion + 1;
                const saved = state.answers[qNum] ?? null;
                const selected = state.pendingChoice ?? saved;
                const questionInfo = getCurrentQuestionInfo();

                app.innerHTML = `
                    <div class="container">
                        <div class="header">
                            <div class="title-box">
                                <h1 class="title">스트레스 취약성 검사</h1>
                            </div>
                        </div>
                        <div class="progress-container">
                            <div class="progress">
                                ${questionInfo.current} / ${questionInfo.total}
                                ${state.questionFilter !== 'all' ? `<span class="filter-text"> (${state.questionFilter === 'answered' ? '답변완료' : '미답변'})</span>` : ''}
                            </div>
                        </div>

                        <div class="question-card card no-animation">
                            <div class="q-number">질문 ${qNum}</div>
                            <div class="q-text">${questions[state.currentQuestion].text}</div>
                        </div>

                        <div class="answer-container">
                            <button class="answer-button ${selected === 3 ? 'selected' : ''}" onclick="selectAnswer(3)">
                                언제나 그렇다 (3점)
                            </button>
                            <button class="answer-button ${selected === 1 ? 'selected' : ''}" onclick="selectAnswer(1)">
                                가끔 그렇다 (1점)
                            </button>
                            <button class="answer-button ${selected === 0 ? 'selected' : ''}" onclick="selectAnswer(0)">
                                전혀 아니다 (0점)
                            </button>
                        </div>

                        <div class="footer-nav">
                            <button class="nav-pill" ${questionInfo.isFirst ? 'disabled' : ''} onclick="goToPrevious()">
                                ← 이전
                            </button>

                            <div class="center-buttons">
                                ${state.currentQuestion === 0 && state.questionFilter === 'all' ? `
                                    <button class="nav-pill dev-button" onclick="state.screen='results'; render();">
                                        결과 바로 보기(개발용)
                                    </button>
                                ` : ''}
                                <button class="nav-pill secondary" onclick="state.screen='review'; render();">
                                    답변 현황
                                </button>
                            </div>

                            <button class="nav-pill" onclick="confirmAndNext()">
                                다음 →
                            </button>
                        </div>
                    </div>
                `;
            }
            
            else if (state.screen === 'review') {
                const answered = getAnsweredQuestions();
                const unanswered = getUnansweredQuestions();

                app.innerHTML = `
                    <div class="container">
                        <div class="header">
                            <div class="title-box">
                                <h1 class="title">답변 현황 확인</h1>
                                <div class="subtitle">총 ${answered.length}개 답변 완료</div>
                            </div>
                        </div>

                        <div class="review-container">
                            <div class="section">
                                <div class="section-title">✅ 답변 완료 (${answered.length})</div>
                                <div class="question-grid">
                                    ${answered.map(q => `
                                        <div class="answered-badge" onclick="state.questionFilter='answered'; goToQuestion(${q-1});">
                                            <div class="q-badge-num">${q}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>

                            ${unanswered.length > 0 ? `
                                <div class="section">
                                    <div class="section-title">❌ 미답변 (${unanswered.length})</div>
                                    <div class="question-grid">
                                        ${unanswered.map(q => `
                                            <div class="unanswered-badge" onclick="state.questionFilter='unanswered'; goToQuestion(${q-1});">
                                                <div class="q-badge-num">${q}</div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>

                        <div class="footer-bar">
                            ${unanswered.length > 0 ? `
                                <button class="nav-pill" onclick="state.questionFilter='unanswered'; state.screen='question'; state.unansweredQuestions=${JSON.stringify(unanswered)}; state.sessionAnsweredCount=0; state.currentQuestion=${unanswered[0]-1}; render();">
                                    미답변 계속하기
                                </button>
                            ` : `
                                <button class="nav-pill" onclick="state.screen='results'; render();">
                                    결과 보기
                                </button>
                            `}
                        </div>
                    </div>
                `;
            }
            
            else if (state.screen === 'results') {
                const scores = calculateScores();
                
                // 신체 영역과 정신 영역 분리
                const physicalTypes = [
                    { key: 'A', label: '식생활' },
                    { key: 'B', label: '금주/금연' },
                    { key: 'C', label: '운동 실천' },
                    { key: 'E', label: '성생활' }
                ];
                
                const mentalTypes = [
                    { key: 'D', label: '정서적 안정' },
                    { key: 'F', label: '여가활동' },
                    { key: 'G', label: '일생활균형' },
                    { key: 'H', label: '자기이해수용' }
                ];
                
                const getCellScore = (qNum) => (state.answers[qNum] ?? '');
                
                // 신호등 색상 및 아이콘
                function getTrafficLight(score) {
                    if (score <= 9) {
                        return { color: '#ef4444', icon: '🔴', text: '주의' };
                    } else if (score >= 15) {
                        return { color: '#10b981', icon: '🟢', text: '양호' };
                    } else {
                        return { color: '#f59e0b', icon: '🟡', text: '보통' };
                    }
                }

                app.innerHTML = `
                    <div class="container">
                        <div class="header">
                            <div class="title-box">
                                <h1 class="title">취약성 프로파일</h1>
                            </div>
                        </div>

                        <!-- 신체 영역 -->
                        <div class="area-section">
                            <div class="area-header">
                                <div class="area-title-box">
                                    <h2 class="area-title">🏃‍♂️ 신체 영역</h2>
                                </div>
                                <div class="area-subtitle">신체적 건강과 관련된 영역</div>
                            </div>
                            
                            <div class="results-grid">
                                ${physicalTypes.map(type => {
                                    const score = scores[type.key];
                                    const trafficLight = getTrafficLight(score);
                                    return `
                                        <div class="type-card">
                                            <div class="type-header">
                                                <div class="type-label">${type.key}유형</div>
                                                <div class="type-name">${type.label}</div>
                                            </div>
                                            
                                            <div class="questions-section">
                                                ${typeInfo[type.key].questions.map(qNum => `
                                                    <div class="question-item">
                                                        <span class="question-num">${qNum}</span>
                                                        <span class="question-score">${getCellScore(qNum)}</span>
                                                    </div>
                                                `).join('')}
                                            </div>
                                            
                                            <div class="score-section">
                                                <div class="traffic-light" style="color: ${trafficLight.color}">
                                                    <span class="traffic-icon">${trafficLight.icon}</span>
                                                    <span class="traffic-text">${trafficLight.text}</span>
                                                </div>
                                                <div class="total-score" style="color: ${trafficLight.color}">
                                                    ${score}점
                                                </div>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>

                        <!-- 정신 영역 -->
                        <div class="area-section">
                            <div class="area-header">
                                <div class="area-title-box">
                                    <h2 class="area-title">🧠 정신 영역</h2>
                                </div>
                                <div class="area-subtitle">정신적 건강과 관련된 영역</div>
                            </div>
                            
                            <div class="results-grid">
                                ${mentalTypes.map(type => {
                                    const score = scores[type.key];
                                    const trafficLight = getTrafficLight(score);
                                    return `
                                        <div class="type-card">
                                            <div class="type-header">
                                                <div class="type-label">${type.key}유형</div>
                                                <div class="type-name">${type.label}</div>
                                            </div>
                                            
                                            <div class="questions-section">
                                                ${typeInfo[type.key].questions.map(qNum => `
                                                    <div class="question-item">
                                                        <span class="question-num">${qNum}</span>
                                                        <span class="question-score">${getCellScore(qNum)}</span>
                                                    </div>
                                                `).join('')}
                                            </div>
                                            
                                            <div class="score-section">
                                                <div class="traffic-light" style="color: ${trafficLight.color}">
                                                    <span class="traffic-icon">${trafficLight.icon}</span>
                                                    <span class="traffic-text">${trafficLight.text}</span>
                                                </div>
                                                <div class="total-score" style="color: ${trafficLight.color}">
                                                    ${score}점
                                                </div>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>

                        <div class="interpretation-guide">
                            <div class="interpretation-title">해석 가이드</div>
                            <div class="traffic-guide">
                                <div class="traffic-item">
                                    <span class="traffic-icon">🟢</span>
                                    <span class="traffic-text">15점 이상: 양호 - 잘 견디고 있다는 증거</span>
                                </div>
                                <div class="traffic-item">
                                    <span class="traffic-icon">🟡</span>
                                    <span class="traffic-text">10-14점: 보통 - 일반적인 수준</span>
                                </div>
                                <div class="traffic-item">
                                    <span class="traffic-icon">🔴</span>
                                    <span class="traffic-text">9점 이하: 주의 - 스트레스에 대한 반응이 부정적 경향</span>
                                </div>
                            </div>
                        </div>

                        <div class="citation">
                            * 출처 : James Cranwell Ward (1990)
                        </div>

                        <div style="height: 100px;"></div>
                    </div>

                    <div class="footer-bar">
                        <button class="nav-pill" onclick="state.screen='plan'; render();">
                            다음
                        </button>
                    </div>
                `;
            }
            
            else if (state.screen === 'plan') {
                app.innerHTML = `
                    <div class="container">
                        <div class="header" style="margin-bottom: 2rem;">
                            <div class="title-box">
                                <h1 class="title">나의 스트레스 관리 실천 전략</h1>
                                <div class="subtitle">자유롭게 계획을 적어보세요</div>
                            </div>
                        </div>

                        <div class="plan-card">
                            <textarea 
                                class="plan-input" 
                                placeholder="예: 매주 3회 운동, 카페인 줄이기, 주말 휴식 시간 확보 등"
                                oninput="state.planText = this.value"
                            >${state.planText}</textarea>
                        </div>
                    </div>

                    <div class="footer-bar">
                        <button class="nav-pill" onclick="state.screen='email'; render();">
                            완료하고 결과 전송하기
                        </button>
                    </div>
                `;
            }
            
            // 🆕 이메일 입력 화면
            else if (state.screen === 'email') {
                app.innerHTML = `
                    <div class="container">
                        <div class="header" style="margin-bottom: 2rem;">
                            <div class="title-box">
                                <h1 class="title">📧 검사 결과 전송</h1>
                                <div class="subtitle">이름과 이메일을 입력해주세요</div>
                            </div>
                        </div>

                        <div class="email-card">
                            <input 
                                type="text" 
                                id="sender-name"
                                class="email-input" 
                                placeholder="이름을 입력하세요"
                                value="${state.senderName}"
                                oninput="state.senderName = this.value"
                                style="margin-bottom: 1rem;"
                            />
                            
                            <input 
                                type="email" 
                                id="email-input"
                                class="email-input" 
                                placeholder="받는 사람 이메일 주소"
                                value="${state.userEmail}"
                                oninput="state.userEmail = this.value"
                            />
                            
                            <button 
                                id="send-button"
                                class="primary-button" 
                                onclick="sendEmail()"
                            >
                                이메일 전송하기
                            </button>
                        </div>
                    </div>

                    <div class="footer-bar">
                        <button class="nav-pill" onclick="state.screen='intro'; resetTest(); render();">
                            처음으로 돌아가기
                        </button>
                    </div>
                `;
            }
            
            // 🆕 이메일 전송 성공 화면
            else if (state.screen === 'email-success') {
                app.innerHTML = `
                    <div class="container">
                        <div class="header" style="margin-bottom: 2rem;">
                            <div class="title-box">
                                <h1 class="title">📧 검사 결과 전송</h1>
                            </div>
                        </div>

                        <div class="success-card">
                            <span class="success-icon">✅</span>
                            <h2 class="success-title">전송 완료!</h2>
                            <p class="success-message">
                                검사 결과와 실천 전략이 성공적으로 전송되었습니다.<br>
                                입력하신 이메일을 확인해주세요.
                            </p>
                        </div>
                    </div>

                    <div class="footer-bar">
                        <button class="nav-pill" onclick="state.screen='intro'; resetTest(); render();">
                            처음으로 돌아가기
                        </button>
                    </div>
                `;
            }
        }

        // 초기 렌더링
        render();
    </script>
</body>
</html>
